+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| > **Service Input - Output Specification**                                                                                                                                |
+:=============:+:=============:+:===================:+:=============:+:=============:+:=============:+:================================:+:================================:+
| > **Project   | > TCBus(.Net)                                       | > **製作者**                                                     |                                  |
| > Name**      |                                                     |                                                                  |                                  |
+---------------+-----------------------------------------------------+------------------------------------------------------------------+----------------------------------+
| > **COM       | > RR_StockTick                                      | > **製作日期**                                                   | > 2020/01/10                     |
| > Name**      |                                                     |                                                                  |                                  |
+---------------+-----------------------------------------------------+------------------------------------------------------------------+----------------------------------+
| **Service     | > D20A280A (210.10.40.10)                           | **Service Desc**                                                 | 個股分時明細                     |
| ID**          |                                                     |                                                                  |                                  |
+---------------+-----------------------------------------------------+------------------------------------------------------------------+----------------------------------+
| **Application | AP Server                                           | **Communication Mode**                                           | SB/SP                            |
| Server**      |                                                     |                                                                  |                                  |
+---------------+-----------------------------------------------------+------------------------------------------------------------------+----------------------------------+
| **Input Spec Table**                                                                                                                                                      |
+-------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| **Function**                  | **bool SubscribeStocktick(List\<Stocktick\>, enumLangType)**                                                                              |
|                               |                                                                                                                                           |
|                               | **bool UnsubscribeStocktick(List\<Stocktick\>, enumLangType)**                                                                            |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| **Fileld Name**               | **Description**     | **Type**                      | **Size**      | **Memo**                                                            |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| **SubscribeStocktick**        | 訂閱個股分時明細    | function                      |               |                                                                     |
|                               |                     |                               |               |                                                                     |
| **UnsubscribeStocktick**      | 解訂閱個股分時明細  |                               |               |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| lstStocktick                  | 訂閱商品清單        | List\<Stocktick\>             |               |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| lng                           | 語系:預設為繁體中文 | enumLangType                  |               | Normal:Big5                                                         |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | UTF8:UTF8                                                           |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | SC:簡體中文                                                         |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| return                        | 結果                | bool                          |               |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| Stocktick                     | 個股分時明細        | Class                         |               |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| [MarketNo]{.mark}             | 市場代碼            | byte                          | #             | #                                                                   |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| [StockCode]{.mark}            | 商品代碼            | string                        | #             | #                                                                   |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| **Output Spec Table**                                                                                                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| **Fileld Name**               | **Description**     | **Type**                      | **Size**      | Memo                                                                |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| abyKey                        | 鍵值                | TByte22                       | # 22          | byMarketNo+abyStkCode                                               |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | (不足補0x00)                                                        |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| byMarketNo                    | 市場代碼            | Byte                          | # 1           |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| abyStkCode                    | 股票代碼            | TByte12                       | # 12          |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| dwSerialNo                    | 序號                | Uint                          | # 4           | 以股票代碼個別編序號，                                              |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 從1開始                                                             |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | (0xFFFFFFFF代表商品清盤)                                            |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| struTime                      |                     |                               | #             |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| byHour                        | 時                  | Byte                          | # 1           |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| byMin                         | 分                  | Byte                          | # 1           |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| bySec                         | 秒                  | Byte                          | # 1           |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| wMSec                         | 毫秒                | usShort                       | # 2           |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| intBuyPrice                   | 買價                | Integer                       | # 4           | 當dwSerialNo=0xFFFFFFFF時,此欄位代表漲停價                          |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 市價買:999999999                                                    |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 前端需除以10000                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| intSellPrice                  | 賣價                | Integer                       | # 4           | 當dwSerialNo=0xFFFFFFFF時,此欄位代表跌停價                          |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 市價賣:-999999999                                                   |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 前端需除以10000                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| intDealPrice                  | 成交價              | Integer                       | # 4           | 當dwSerialNo=0xFFFFFFFF時,此欄位代表開盤參考價                      |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 前端需除以10000                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| dwDealVol                     | 成交量              | Uint                          | # 4           |                                                                     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| byInOutFlag                   | 內外盤註記          | Byte                          | # 1           | 0:內盤                                                              |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 1:外盤                                                              |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 2:定價內盤                                                          |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 3:定價外盤                                                          |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 10:一般揭示                                                         |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 11:暫緩撮合且瞬間趨跌                                               |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 12:暫緩撮合且瞬間趨漲                                               |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 13:試算後延後收盤                                                   |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 14:暫停交易                                                         |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 15:恢復交易                                                         |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 註1：當是10,11,12,13時,只有市場碼與股票代碼有值,其餘的欄位皆是0     |
|                               |                     |                               |               |                                                                     |
|                               |                     |                               |               | 註2：當是14,15時,只有市場碼、股票代碼與時間有值,其餘的欄位皆是0     |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
| byType                        | 明細類別            | Byte                          | # 1           | 0:Normal                                                            |
+-------------------------------+---------------------+-------------------------------+---------------+---------------------------------------------------------------------+
