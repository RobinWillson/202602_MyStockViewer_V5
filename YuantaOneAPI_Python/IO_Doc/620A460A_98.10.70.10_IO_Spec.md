+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Service Input - Output Specification**                                                                                                                                              |
+:==============:+:==============:+:===============:+:============:+:============:+:============:+:=============:+:====================================================================:+
| **Project      | TCBus(.Net)                                     | **製作者**                  |                                                                                      |
| Name**         |                                                 |                             |                                                                                      |
+----------------+-------------------------------------------------+-----------------------------+--------------------------------------------------------------------------------------+
| **COM Name**   | RR_WatclistAll                                  | **製作日期**                | 2020/01/10                                                                           |
+----------------+-------------------------------------------------+-----------------------------+--------------------------------------------------------------------------------------+
| **Service ID** | 620A460A (98.10.70.10)                          | **Service Desc**            | WatchList(報價表)行情資料                                                            |
+----------------+-------------------------------------------------+-----------------------------+--------------------------------------------------------------------------------------+
| **Application  | AP Server                                       | **Communication Mode**      | SB/SP                                                                                |
| Server**       |                                                 |                             |                                                                                      |
+----------------+-------------------------------------------------+-----------------------------+--------------------------------------------------------------------------------------+
| **Input Spec Table**                                                                                                                                                                  |
+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| **Function**                    | **bool SubscribeWatchlistAll(List\<WatchlistAll\>, enumLangType)**                                                                                  |
|                                 |                                                                                                                                                     |
|                                 | **bool UnsubscribeWatchlistAll(List\<WatchlistAll\>, enumLangType)**                                                                                |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| **Fileld Name**                 | **Description** | **Type**                    | **Size**                     | **Memo**                                                             |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| **SubscribeWatchlistAll**       | 訂閱報價表      | function                    |                              |                                                                      |
|                                 |                 |                             |                              |                                                                      |
| **UnsubscribeWatchlistAll**     | 解訂閱報價表    |                             |                              |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| lstWatchlistAll                 | 訂閱商品清單    | List\<WatchlistAll\>        |                              |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| WatchlistAll                    | 報價表          | Class                       |                              |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| [MarketNo]{.mark}               | 市場代碼        | byte                        | #                            | #                                                                    |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| [StockCode]{.mark}              | 商品代碼        | string                      | #                            | #                                                                    |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| return                          | 結果            | bool                        |                              |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| **Output Spec Table**                                                                                                                                                                 |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| **Fileld Name**                 | **Description** | **Type**                    | **Size**                     | **Memo**                                                             |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| abyKey                          | 鍵值            | TByte22                     | # 22                         | byMarketNo+abyStkCode (不足補0x00)                                   |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| byMarketNo                      | 市場代碼        | Byte                        | # 1                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| abyStkCode                      | 股票代碼        | TByte12                     | # 12                         |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| llSeqNo                         | 序號            | Long                        | 8                            | 090000000000。                                                       |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 後八碼表序號，前四碼表時間                                           |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| byIndexFlag                     | 索引值          | Byte                        | # 1                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| struRecord                      |                 |                             | #                            | byIndexFlag\>=0                                                      |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | and byIndexFlag\<=48                                                 |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| intValue                        | 資料值          | Integer                     | 4                            | 索引值=0,代表值=開盤                                                 |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=1,代表值=最高                                                 |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=2,代表值=最低                                                 |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=11,代表值=定價量                                              |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=12,代表值=未平倉量                                            |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=13,代表值=結算價                                              |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=14,代表值=合約高價                                            |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=15,代表值=合約低價                                            |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=16,代表值=委託買進總筆數                                      |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=17,代表值=委託買進總口數                                      |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=18,代表值=委託賣出總筆數                                      |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=19,代表值=委託賣出總口數                                      |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=20,代表值=累計買進成交筆數                                    |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=21,代表值=累計賣出成交筆數                                    |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=24,代表值=虛擬最佳一檔買進價                                  |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=25,代表值=虛擬最佳一檔買進量                                  |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=26,代表值=虛擬最佳一檔賣出價                                  |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=27,代表值=虛擬最佳一檔賣出量                                  |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=48,代表值=瞬間價格趨勢(                                       |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 10: 一般揭示                                                         |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 11: 暫緩撮合且瞬間趨跌                                               |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 12: 暫緩撮合且瞬間趨漲                                               |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 13: 試算後延後收盤                                                   |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 14: 暫停交易                                                         |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 15: 恢復交易                                                         |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 16: 試算後延後開盤)                                                  |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=240,代表值=交易狀態(                                          |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 0x00: 初始狀態                                                       |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 0x01: 收單階段                                                       |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 0x02: 不可刪單階段                                                   |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 0x03: 集合競價階段)                                                  |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=241,試撮成交價                                                |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=242,試摱成交量(最高位元的Bit,表示內/外盤的旗標,0:內盤/1:外盤) |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=254,代表值=開盤參考價                                         |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 索引值=255,代表值=開盤參考價(清盤用)                                 |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| struRecord                      |                 |                             |                              | byIndexFlag=28                                                       |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| intBuyPrice                     | 買價            | Integer                     | # 4                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| intSellPrice                    | 賣價            | Integer                     | # 4                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| struRecord                      |                 |                             | #                            | byIndexFlag=29                                                       |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| byHour                          | 時              | Byte                        | # 1                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| byMin                           | 分              | Byte                        | # 1                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| bySec                           | 秒              | Byte                        | # 1                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| wMSec                           | 毫秒            | usShort                     | # 2                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| dwTotalOutVol                   | 累計外盤量      | Uint                        | # 4                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| dwTotalInVol                    | 累計內盤量      | Uint                        | # 4                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| intDeal                         | 成交價          | Integer                     | # 4                          | 前端需除以10000                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| dwVol                           | 單量            | Uint                        | # 4                          | 最高位元的Bit，                                                      |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 表示內/外盤的旗標，                                                  |
|                                 |                 |                             |                              |                                                                      |
|                                 |                 |                             |                              | 0:內盤/1:外盤                                                        |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| dwTotalVol                      | 總成交量        | Uint                        | # 4                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| dwTotalAmt                      | 總成交金額      | Uint                        | # 4                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| struRecord                      |                 |                             | #                            | byIndexFlag=22                                                       |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| dwBuyVol                        | 第一買量        | Uint                        | # 4                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
| dwSellVol                       | 第一賣量        | Uint                        | # 4                          |                                                                      |
+---------------------------------+-----------------+-----------------------------+------------------------------+----------------------------------------------------------------------+
