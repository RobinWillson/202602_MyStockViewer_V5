+--------------------------------------------------------------------------------------------------------------------------------------+
| **Service Input - Output Specification**                                                                                             |
+:================:+:===================:+:===============:+:===============:+:===============:+:=================:+:=================:+
| **Project Name** | TCBus(.Net)                           | **製作者**                                            |                   |
+------------------+---------------------------------------+-------------------------------------------------------+-------------------+
| **COM Name**     | OdrStkSOrder                          | **製作日期**                                          | 2020/01/10        |
+------------------+---------------------------------------+-------------------------------------------------------+-------------------+
| **Service ID**   | 1E640A1F (30.100.10.31)               | **Service Desc**                                      | 現貨下單          |
+------------------+---------------------------------------+-------------------------------------------------------+-------------------+
| **Application    | AP Server                             | **Communication Mode**                                | RQ/RP             |
| Server**         |                                       |                                                       |                   |
+------------------+---------------------------------------+-------------------------------------------------------+-------------------+
| **Input Spec Table**                                                                                                                 |
+------------------+-------------------------------------------------------------------------------------------------------------------+
| **Function**     | **bool SendStockOrder(string , List\<StockOrder\>, enumLangType)**                                                |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| **Fileld Name**  | **Description**     | **Type**                          | **Size**        | **Memo**                              |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| SendStockOrder   | 國內證券下單        | function                          |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| LoginAcno        | 欲下單帳號          | string                            |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| lstStockOrder    | 下單物件            | List\<StockOrder\>                |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| lng              | 語系:預設為繁體中文 | enumLangType                      |                 | Normal:Big5                           |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | UTF8:UTF8                             |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | SC:簡體中文                           |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| return           | 結果                | bool                              |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| **StockOrder**   | 下單物件            | Class                             |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| Identity         | 識別碼              | int                               |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| Account          | 下單帳號            | string                            |                 | 完整帳號:如S98875005091               |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| OrderNo          | 委託書編號          | string                            |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| TradeDate        | 交易日期            | string                            |                 | yyyy/MM/dd                            |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| APCode           | 交易單市場別        | short                             |                 | 0:一般                                |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 2:零股                                |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 4:盤中零股                            |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 7:盤後                                |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| TradeKind        | 交易性質            | short                             |                 | 00:委託單                             |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 03:改量                               |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 04:取消                               |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 07:改價                               |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| OrderType        | 委託種類            | string                            |                 | \"0\":現貨                            |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | \"3\":融資                            |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | \"4\":融券                            |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | \"5\":策略借券(賣出)                  |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | \"6\":避險借券(賣出)                  |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | \"9\":現股當沖委託控管                |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| StkCode          | 股票代號            | string                            |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| BuySell          | 買賣記號            | string                            |                 | \"B\":買                              |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | \"S\":賣                              |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| PriceFlag        | 價格種類            | string                            |                 | H:漲停                                |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | -:平盤                                |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | L:跌停                                |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | \" \":限價                            |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | M:市價單                              |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| Price            | 委託價格            | long                              |                 | 請\*10000                             |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| BasketNo         | 使用者自訂欄位      | string                            |                 | (限32個英數字內)                      |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| SellerNo         | 營業員代號          | short                             |                 | 固定填0                               |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| OrderQty         | 委託單位            | long                              |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| ~~LotSize~~      | ~~每手股數~~        | ~~uint~~                          |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| Time_in_force    | 委託時間效期        | string                            |                 | 0:ROD                                 |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 3:IOC                                 |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 4:FOK                                 |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| **Output Spec Table**                                                                                                                |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| **Fileld Name**  | **Description**     | **Type**                          | **Size**        | Memo                                  |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| ParentStruct_Out | 下單筆數Structure   | Struct                            |                 |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| abyMsgCode       | 訊息代碼            | TByte4                            | 4               | 0001:執行成功                         |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | 其它:失敗                             |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| abyMsgContent    | 訊息內容            | TByte75                           | 75              | Max:25中文                            |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| uintCount        | 筆數                | Uint                              | 4               |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| ChildStruct_Out  | 下單結果Structure   | Struct                            |                 | Loop(uintCount)                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| intIdentify      | 識別碼              | Int                               | 4               |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| shtReplyCode     | 委託結果代碼        | Short                             | 2               | 0:委託成功                            |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | others:委託失敗                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| abyOrderNO       | 委託書編號          | Tbyte5                            | 5               |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| struTradeDate    | 交易日期            | TYuantaDate                       | 4               |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| abyErrType       | 錯誤類別            | TByte                             | 1               |                                       |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| abyErrNO         | 錯誤代號            | TByte3                            | 3               | A003:預約單不支援改價或無此委託單     |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | A004:委託已成交，無法改價             |
|                  |                     |                                   |                 |                                       |
|                  |                     |                                   |                 | A005:委託已取消，無法改價             |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
| abyAdvisory      | 錯誤說明            | TByte120                          | 120             | Max:40中文                            |
+------------------+---------------------+-----------------------------------+-----------------+---------------------------------------+
